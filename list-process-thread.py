import psutil

for proc in psutil.process_iter():
  print proc.name(), proc.pid
  #try:
  current_process = psutil.Process(proc.pid)
  children = current_process.children(recursive=True)
  for child in children:
    childStr = str(child)
    childStr = childStr[(childStr.find('name=') + 6):]
    childStr = childStr[:childStr.find('\'')]
    print childStr
  #except psutil.AccessDenied:
  #  pass
